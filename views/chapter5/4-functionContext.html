{% extends '../layout.html' %}
{% block title %}5closure{% parent %}{% endblock %}

{% block content %}
<em>函数上下文</em>                
{% parent %}

<button id="test">Click Me!</button>
{% endblock %}

{% block foot %}
{% parent %}
<script>
window.onload = function(){
	function bind(context, name){
		return function(){
			return context[name].apply(context, arguments);
		}
	}
	var button = {
		clicked: false,
		click: function(){
			this.clicked = true;

			assert(button.clicked, 'The button has been clicked');
			assert(button.clicked, this);
		}
	};
	var elem = document.getElementById('test');
	elem.addEventListener('click', bind(button, 'click'), false);

	Function.prototype.bind = function(){
		var fn = this, args = Array.prototype.slice.call(arguments),
			object = args.shift();
		return function(){
			return fn.apply(object, args.concat(Array.prototype.slice.call(arguments)));
		};
	};

	var myObject = {};
	function myFunction(){
		return this === myObject;
	}
	assert(!myFunction(), 'Context is not set yet');
	var aFunction = myFunction.bind(myObject);
	assert(aFunction(), 'Context is set properly');
}
</script>
{% endblock %}  